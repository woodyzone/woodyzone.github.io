(function(){"use strict";var t={9631:function(t,e,n){var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-container"},[e("Layout",{scopedSlots:t._u([{key:"left",fn:function(){return[e("div",{staticClass:"left"},[e("SiteAside")],1)]},proxy:!0}])},[e("div",{staticClass:"main"},[e("RouterView")],1)])],1)},s=[],i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"site-aside-container"},[e("div",{staticClass:"avatar"},[e("Avatar")],1),e("h1",{staticStyle:{"text-align":"center"}},[t._v("包子")]),e("Menu"),e("Contact")],1)},o=[],c=function(){var t=this,e=t._self._c;return e("img",{staticClass:"avatar-container",style:t.borderStyle,attrs:{src:t.url}})},r=[],l={props:{url:{type:String,default:"https://i.pinimg.com/474x/1d/81/21/1d81216394b2eef725f7a3d6530441c2.jpg"},size:{type:Number,default:150},isSolid:{type:Boolean,default:!1}},computed:{borderStyle(){return{borderStyle:this.isSolid?"solid":"dashed",width:`${this.size}px`,height:`${this.size}px`}}}},d=l,p=n(1656),m=(0,p.A)(d,c,r,!1,null,"029de42e",null),u=m.exports,h=function(){var t=this,e=t._self._c;return e("nav",{staticClass:"menu-container"},t._l(t.items,(function(n){return e("RouterLink",{key:n.link,staticClass:"item",attrs:{exact:n.exact,to:{name:n.name},"active-class":"active","exact-active-class":""}},[e("div",[e("Icon",{staticClass:"icon",attrs:{type:n.iconType}})],1),e("span",[t._v(t._s(n.text))])])})),1)},g=[],f=function(){var t=this,e=t._self._c;return e("i",{staticClass:"iconfont icon-container",class:t.realClass})},b=[];const v={empty:"icon-kong",arrowDown:"icon-arrow-down",arrowUp:"icon-arrowup",github:"icon-github-fill",wechat:"icon-weixin",qq:"icon-qq",mail:"icon-youxiang",home:"icon-shouye",blog:"icon-gangbi",about:"icon-guanyu",code:"icon-code",message:"icon-liuyan",info:"icon-xinxi",danger:"icon-weixian",success:"icon-chenggong",warn:"icon-jinggao"};var y={props:{type:{type:String,required:!0}},computed:{realClass(){return v[this.type]}}},_=y,w=(0,p.A)(_,f,b,!1,null,"5708309a",null),C=w.exports,x={components:{Icon:C},data(){return{a:"zzl",items:[{iconType:"home",text:"首页",name:"home",exact:!0},{iconType:"blog",text:"文章",name:"blog",exact:!1},{iconType:"about",text:"关于",name:"about",exact:!0},{iconType:"code",text:"画廊&DEMO",name:"project",exact:!0},{iconType:"message",text:"播放器",name:"message",exact:!0}]}}},j=x,L=(0,p.A)(j,h,g,!1,null,"8f3cbc5e",null),S=L.exports,k=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"contact-container"},[e("li",[e("a",[e("div",{staticClass:"icon"},[e("Icon",{attrs:{type:"github"}})],1),e("span",[t._v("github.com")])]),t._m(0)]),e("li",[e("a",{attrs:{href:"mailto:woodyzone402@gmail.com"}},[e("div",{staticClass:"icon"},[e("Icon",{attrs:{type:"mail"}})],1),e("span",[t._v("woodyzone402@gmail.com")])])]),e("li",[e("a",[e("div",{staticClass:"icon"},[e("Icon",{attrs:{type:"wechat"}})],1),e("span",[t._v("LZZEERF")])])]),e("li",[e("a",[e("div",{staticClass:"icon"},[e("Icon",{attrs:{type:"qq"}})],1),e("span",[t._v("1466034796")])]),t._m(1)])])},A=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"pop"},[e("img",{attrs:{src:"https://i.pinimg.com/474x/f4/47/79/f44779bcedd3544db85017a930caa719.jpg",alt:""}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"pop"},[e("img",{attrs:{src:"https://i.pinimg.com/474x/4e/12/db/4e12dbcccd5f3d80971bfc56d194c15c.jpg",alt:""}})])}],D={components:{Icon:C}},q=D,T=(0,p.A)(q,k,A,!1,null,"5c97a519",null),O=T.exports,N={components:{Avatar:u,Menu:S,Contact:O}},I=N,$=(0,p.A)(I,i,o,!1,null,"1af69836",null),P=$.exports,R=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout-container"},[e("div",{staticClass:"left"},[t._t("left")],2),e("div",{staticClass:"main"},[t._t("default")],2),e("div",{staticClass:"right"},[t._t("right")],2)])},z=[],H={},M=H,E=(0,p.A)(M,R,z,!1,null,"43cf5622",null),B=E.exports,J={components:{Layout:B,SiteAside:P},created(){this.$on("help",this.handler)}},U=J,K=(0,p.A)(U,a,s,!1,null,"48c796a4",null),F=K.exports,X=n(4240),Z=n.n(X);Z().mock("/api/banner","get",{code:0,msg:"",data:[{id:"1",bigImg:"https://w.wallhaven.cc/full/2y/wallhaven-2yjp6x.png",title:"BRONX",description:"first"},{id:"2",bigImg:"https://w.wallhaven.cc/full/2y/wallhaven-2yx5og.jpg",title:"WoodyZone",description:"second"},{id:"3",bigImg:"https://w.wallhaven.cc/full/zy/wallhaven-zy2x7v.png",title:"KL404",description:"third"}]});var W=n(8031);Z().mock("/api/blogtype","get",{code:0,msg:"","data|5-10":[{"id|+1":1,name:"分类@id","articleCount|0-100":0,order:"@id"}]}),Z().mock(/^\/api\/blog(\?.+)?$/,"get",(function(t){const e=W.parse(t.url);return Z().mock({code:0,msg:"",data:{"total|2000-3000":0,[`rows|${e.limit||10}`]:[{id:"@guid",title:"@ctitle",description:"@cparagraph(1, 10)",category:{"id|1-10":0,name:"分类@id"},"scanNumber|0-3000":0,"commentNumber|0-300":30,"thumb|1":["https://gd-hbimg.huaban.com/04c1b2f3e01f21718a0d8abb91745fc237d4acbd13d222-E5zlUk_fw480webp","https://gd-hbimg.huaban.com/8d6d614dbbb9e041a5e00d35722c2ad6ecff321471a3d-okJQal_fw480webp","https://gd-hbimg.huaban.com/13e5b6fe7757283a6f71437bff87dc942576367a8717f-WIpyxE_fw480webp","https://gd-hbimg.huaban.com/162ed947688494f22fb8fbe3e3509b9ef034ed3b7a9b2-G9i9L8_fw480webp","https://gd-hbimg.huaban.com/e716073b8e372e9646b0c19b7397192f612447ce866c-OESoKv_fw480webp","https://gd-hbimg.huaban.com/6521f3fa40eb61d3eae900b48cf7374e3e23de3618ce9-Na84pn_fw480webp","https://gd-hbimg.huaban.com/3be07ae49258b3b5583986a2383b07ee158e99319d232-DRKDZx_fw480webp","https://gd-hbimg.huaban.com/424b24f3f9e37a84ae8b40ad8eb70b2bcf10fe221fea2-VPC3Sy_fw480webp","https://gd-hbimg.huaban.com/a8c678ae4b498f7766b50fd77d2e939693284a4b32b1a-ZXaOoF_fw480webp","https://gd-hbimg.huaban.com/53967161e3ae19eb0d7aa2f142fa93cdd4ef5ed81b9de-pHn8P2_fw480webp","https://gd-hbimg.huaban.com/043dc416cb0ecd59b17b5dd35ea94b765466a34715c552-etldHU_fw480webp","https://gd-hbimg.huaban.com/a59c29729bc19e5309a45a20840f19da48fb51b7adbd8-uA7qvP_fw480webp","https://gd-hbimg.huaban.com/f185c1b5c89da46cbe7d675909c6c070b5465c1be3acd-vJd1de_fw480webp","https://gd-hbimg.huaban.com/006b9d05fb7ddd3b0ec9abf52f3fb281e428f6101b24c2-GHheNm_fw480webp","https://gd-hbimg.huaban.com/0b947e2ee8e8c3adf6efbaabb720019614fe095025330-ARWve7_fw480webp","https://gd-hbimg.huaban.com/539913ba33aa18ccaa9ab3ae89717aea463ce299e7e00-BS9Upe_fw480webp","https://gd-hbimg.huaban.com/67888637b99b358ea82b3542a9c55e83bf9e746726614-G6qRA9_fw480webp","https://gd-hbimg.huaban.com/223539f45fae4113617b7a3a3d28e48541e7180ae4fb0-PXUZzn_fw480webp","https://gd-hbimg.huaban.com/bed37b4d9145dd7ce5eaf877d83c5f6a7d7f9eb3bf33a-LuGgEC_fw480webp","https://gd-hbimg.huaban.com/d95ee1c5bd82fc3d98e5ba087f7b063c9d3f4218341a-KYsBJT_fw480webp",null],createDate:"@date()"}]}})})),Z().mock(/^\/api\/blog\/[^/]+$/,"get",{code:0,msg:"",data:{id:"@guid",title:"CORS跨域方案详解",category:{"id|1-10":1,name:"分类@id"},description:"@cparagraph(1, 10)","scanNumber|0-10000":0,"commentNumber|0-100":0,createDate:"@date()",toc:[{name:"概述",anchor:"article-md-title-1"},{name:"简单请求",anchor:"article-md-title-2",children:[{name:"简单请求的判定",anchor:"article-md-title-3"},{name:"简单请求的交互规范",anchor:"article-md-title-4"}]},{name:"需要预检的请求",anchor:"article-md-title-5"},{name:"附带身份凭证的请求",anchor:"article-md-title-6"},{name:"一个额外的补充",anchor:"article-md-title-7"}],"thumb|1":[Z().Random.image("300x250","#000","#fff","Random Image"),null],htmlContent:'<blockquote>\n    <p>阅读本文，你需要首先知道：</p><ol>\n    <li>浏览器的同源策略</li>\n    <li>跨域问题</li>\n    <li>JSONP原理</li>\n    <li>cookie原理</li>\n    </ol>\n    </blockquote>\n    <p>JSONP并不是一个好的跨域解决方案，它至少有着下面两个严重问题：</p><ol>\n    <li><strong>会打乱服务器的消息格式</strong>：JSONP要求服务器响应一段JS代码，但在非跨域的情况下，服务器又需要响应一个正常的JSON格式</li>\n    <li><strong>只能完成GET请求</strong>：JSONP的原理会要求浏览器端生成一个<code>script</code>元素，而<code>script</code>元素发出的请求只能是<code>get</code>请求</li>\n    </ol>\n    <p>所以，CORS是一种更好的跨域解决方案。</p><h1 id="article-md-title-1">概述</h1><p><code>CORS</code>是基于<code>http1.1</code>的一种跨域解决方案，它的全称是<strong>C</strong>ross-<strong>O</strong>rigin <strong>R</strong>esource <strong>S</strong>haring，跨域资源共享。</p><p>它的总体思路是：<strong>如果浏览器要跨域访问服务器的资源，需要获得服务器的允许</strong></p><figure class="markdown-image">\n          \n          <img style="width:auto" src="http://mdrs.yuanjin.tech/img/image-20200421152122793.png" title="image-20200421152122793" alt="image-20200421152122793">\n          <figcaption>image-20200421152122793</figcaption>\n      \n        </figure><p>而要知道，一个请求可以附带很多信息，从而会对服务器造成不同程度的影响</p><p>比如有的请求只是获取一些新闻，有的请求会改动服务器的数据</p><p>针对不同的请求，CORS规定了三种不同的交互模式，分别是：</p><ul>\n    <li><strong>简单请求</strong></li>\n    <li><strong>需要预检的请求</strong></li>\n    <li><strong>附带身份凭证的请求</strong></li>\n    </ul>\n    <p>这三种模式从上到下层层递进，请求可以做的事越来越多，要求也越来越严格。</p><p>下面分别说明三种请求模式的具体规范。</p><h1 id="article-md-title-2">简单请求</h1><p>当浏览器端运行了一段ajax代码（无论是使用XMLHttpRequest还是fetch api），浏览器会首先判断它属于哪一种请求模式</p><h2 id="article-md-title-3">简单请求的判定</h2><p>当请求<strong>同时满足</strong>以下条件时，浏览器会认为它是一个简单请求：</p><ol>\n    <li><p><strong>请求方法属于下面的一种：</strong></p><ul>\n    <li>get</li>\n    <li>post</li>\n    <li>head</li>\n    </ul>\n    </li>\n    <li><p><strong>请求头仅包含安全的字段，常见的安全字段如下：</strong></p><ul>\n    <li><code>Accept</code></li>\n    <li><code>Accept-Language</code></li>\n    <li><code>Content-Language</code></li>\n    <li><code>Content-Type</code></li>\n    <li><code>DPR</code></li>\n    <li><code>Downlink</code></li>\n    <li><code>Save-Data</code></li>\n    <li><code>Viewport-Width</code></li>\n    <li><code>Width</code></li>\n    </ul>\n    </li>\n    <li><p><strong>请求头如果包含<code>Content-Type</code>，仅限下面的值之一：</strong></p><ul>\n    <li><code>text/plain</code></li>\n    <li><code>multipart/form-data</code></li>\n    <li><code>application/x-www-form-urlencoded</code></li>\n    </ul>\n    </li>\n    </ol>\n    <p>如果以上三个条件同时满足，浏览器判定为简单请求。</p><p>下面是一些例子：</p><pre><code class="language-js"><span class="hljs-comment">// 简单请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>);\n    \n    <span class="hljs-comment">// 请求方法不满足要求，不是简单请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n      <span class="hljs-attr">method</span>:<span class="hljs-string">"PUT"</span>\n    })\n    \n    <span class="hljs-comment">// 加入了额外的请求头，不是简单请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n      <span class="hljs-attr">headers</span>:{\n        <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>\n      }\n    })\n    \n    <span class="hljs-comment">// 简单请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n      <span class="hljs-attr">method</span>: <span class="hljs-string">"post"</span>\n    })\n    \n    <span class="hljs-comment">// content-type不满足要求，不是简单请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n      <span class="hljs-attr">method</span>: <span class="hljs-string">"post"</span>,\n      <span class="hljs-attr">headers</span>: {\n        <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>\n      }\n    })</code></pre>\n    <h2 id="article-md-title-4">简单请求的交互规范</h2><p>当浏览器判定某个<strong>ajax跨域请求</strong>是<strong>简单请求</strong>时，会发生以下的事情</p><ol>\n    <li><strong>请求头中会自动添加<code>Origin</code>字段</strong></li>\n    </ol>\n    <p>比如，在页面<code>http://my.com/index.html</code>中有以下代码造成了跨域</p><pre><code class="language-js"><span class="hljs-comment">// 简单请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>);</code></pre>\n    <p>请求发出后，请求头会是下面的格式：</p><pre><code>GET /api/news/ HTTP/1.1\n    Host: crossdomain.com\n    Connection: keep-alive\n    ...\n    Referer: http://my.com/index.html\n    Origin: http://my.com</code></pre><p>看到最后一行没，<code>Origin</code>字段会告诉服务器，是哪个源地址在跨域请求</p><ol start="2">\n    <li><strong>服务器响应头中应包含<code>Access-Control-Allow-Origin</code></strong></li>\n    </ol>\n    <p>当服务器收到请求后，如果允许该请求跨域访问，需要在响应头中添加<code>Access-Control-Allow-Origin</code>字段</p><p>该字段的值可以是：</p><ul>\n    <li>*：表示我很开放，什么人我都允许访问</li>\n    <li>具体的源：比如<code>http://my.com</code>，表示我就允许你访问</li>\n    </ul>\n    <blockquote>\n    <p>实际上，这两个值对于客户端<code>http://my.com</code>而言，都一样，因为客户端才不会管其他源服务器允不允许，就关心自己是否被允许</p><p>当然，服务器也可以维护一个可被允许的源列表，如果请求的<code>Origin</code>命中该列表，才响应<code>*</code>或具体的源</p><p><strong>为了避免后续的麻烦，强烈推荐响应具体的源</strong></p></blockquote>\n    <p>假设服务器做出了以下的响应：</p><pre><code>HTTP/1.1 200 OK\n    Date: Tue, 21 Apr 2020 08:03:35 GMT\n    ...\n    Access-Control-Allow-Origin: http://my.com\n    ...\n    \n    消息体中的数据</code></pre><p>当浏览器看到服务器允许自己访问后，高兴的像一个两百斤的孩子，于是，它就把响应顺利的交给js，以完成后续的操作</p><p>下图简述了整个交互过程</p><figure class="markdown-image">\n          \n          <img style="width:auto" src="http://mdrs.yuanjin.tech/img/image-20200421162846480.png" title="image-20200421162846480" alt="image-20200421162846480">\n          <figcaption>image-20200421162846480</figcaption>\n      \n        </figure><h1 id="article-md-title-5">需要预检的请求</h1><p>简单的请求对服务器的威胁不大，所以允许使用上述的简单交互即可完成。</p><p>但是，如果浏览器不认为这是一种简单请求，就会按照下面的流程进行：</p><ol>\n    <li><strong>浏览器发送预检请求，询问服务器是否允许</strong></li>\n    <li><strong>服务器允许</strong></li>\n    <li><strong>浏览器发送真实请求</strong></li>\n    <li><strong>服务器完成真实的响应</strong></li>\n    </ol>\n    <p>比如，在页面<code>http://my.com/index.html</code>中有以下代码造成了跨域</p><pre><code class="language-js"><span class="hljs-comment">// 需要预检的请求</span>\n    fetch(<span class="hljs-string">"http://crossdomain.com/api/user"</span>, {\n      <span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>, <span class="hljs-comment">// post 请求</span>\n      <span class="hljs-attr">headers</span>:{  <span class="hljs-comment">// 设置请求头</span>\n        <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,\n        <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,\n        <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>\n      },\n      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">name</span>: <span class="hljs-string">"袁小进"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> }) <span class="hljs-comment">// 设置请求体</span>\n    });</code></pre>\n    <p>浏览器发现它不是一个简单请求，则会按照下面的流程与服务器交互</p><ol>\n    <li><strong>浏览器发送预检请求，询问服务器是否允许</strong></li>\n    </ol>\n    <pre><code>OPTIONS /api/user HTTP/1.1\n    Host: crossdomain.com\n    ...\n    Origin: http://my.com\n    Access-Control-Request-Method: POST\n    Access-Control-Request-Headers: a, b, content-type</code></pre><p>可以看出，这并非我们想要发出的真实请求，请求中不包含我们的响应头，也没有消息体。</p><p>这是一个预检请求，它的目的是询问服务器，是否允许后续的真实请求。</p><p>预检请求<strong>没有请求体</strong>，它包含了后续真实请求要做的事情</p><p>预检请求有以下特征：</p><ul>\n    <li>请求方法为<code>OPTIONS</code></li>\n    <li>没有请求体</li>\n    <li>请求头中包含<ul>\n    <li><code>Origin</code>：请求的源，和简单请求的含义一致</li>\n    <li><code>Access-Control-Request-Method</code>：后续的真实请求将使用的请求方法</li>\n    <li><code>Access-Control-Request-Headers</code>：后续的真实请求会改动的请求头</li>\n    </ul>\n    </li>\n    </ul>\n    <ol start="2">\n    <li><strong>服务器允许</strong></li>\n    </ol>\n    <p>服务器收到预检请求后，可以检查预检请求中包含的信息，如果允许这样的请求，需要响应下面的消息格式</p><pre><code>HTTP/1.1 200 OK\n    Date: Tue, 21 Apr 2020 08:03:35 GMT\n    ...\n    Access-Control-Allow-Origin: http://my.com\n    Access-Control-Allow-Methods: POST\n    Access-Control-Allow-Headers: a, b, content-type\n    Access-Control-Max-Age: 86400\n    ...</code></pre><p>对于预检请求，不需要响应任何的消息体，只需要在响应头中添加：</p><ul>\n    <li><code>Access-Control-Allow-Origin</code>：和简单请求一样，表示允许的源</li>\n    <li><code>Access-Control-Allow-Methods</code>：表示允许的后续真实的请求方法</li>\n    <li><code>Access-Control-Allow-Headers</code>：表示允许改动的请求头</li>\n    <li><code>Access-Control-Max-Age</code>：告诉浏览器，多少秒内，对于同样的请求源、方法、头，都不需要再发送预检请求了</li>\n    </ul>\n    <ol start="3">\n    <li><strong>浏览器发送真实请求</strong></li>\n    </ol>\n    <p>预检被服务器允许后，浏览器就会发送真实请求了，上面的代码会发生下面的请求数据</p><pre><code>POST /api/user HTTP/1.1\n    Host: crossdomain.com\n    Connection: keep-alive\n    ...\n    Referer: http://my.com/index.html\n    Origin: http://my.com\n    \n    {"name": "袁小进", "age": 18 }</code></pre><ol start="4">\n    <li><strong>服务器响应真实请求</strong></li>\n    </ol>\n    <pre><code>HTTP/1.1 200 OK\n    Date: Tue, 21 Apr 2020 08:03:35 GMT\n    ...\n    Access-Control-Allow-Origin: http://my.com\n    ...\n    \n    添加用户成功</code></pre><p>可以看出，当完成预检之后，后续的处理与简单请求相同</p><p>下图简述了整个交互过程</p><figure class="markdown-image">\n          \n          <img style="width:auto" src="http://mdrs.yuanjin.tech/img/image-20200421165913320.png" title="image-20200421165913320" alt="image-20200421165913320">\n          <figcaption>image-20200421165913320</figcaption>\n      \n        </figure><h1 id="article-md-title-6">附带身份凭证的请求</h1><p>默认情况下，ajax的跨域请求并不会附带cookie，这样一来，某些需要权限的操作就无法进行</p><p>不过可以通过简单的配置就可以实现附带cookie</p><pre><code class="language-js"><span class="hljs-comment">// xhr</span>\n    <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();\n    xhr.withCredentials = <span class="hljs-literal">true</span>;\n    \n    <span class="hljs-comment">// fetch api</span>\n    fetch(url, {\n      <span class="hljs-attr">credentials</span>: <span class="hljs-string">"include"</span>\n    })</code></pre>\n    <p>这样一来，该跨域的ajax请求就是一个<em>附带身份凭证的请求</em></p><p>当一个请求需要附带cookie时，无论它是简单请求，还是预检请求，都会在请求头中添加<code>cookie</code>字段</p><p>而服务器响应时，需要明确告知客户端：服务器允许这样的凭据</p><p>告知的方式也非常的简单，只需要在响应头中添加：<code>Access-Control-Allow-Credentials: true</code>即可</p><p>对于一个附带身份凭证的请求，若服务器没有明确告知，浏览器仍然视为跨域被拒绝。</p><p>另外要特别注意的是：<strong>对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin 的值为*</code></strong>。这就是为什么不推荐使用*的原因</p><h1 id="article-md-title-7">一个额外的补充</h1><p>在跨域访问时，JS只能拿到一些最基本的响应头，如：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma，如果要访问其他头，则需要服务器设置本响应头。</p><p><code>Access-Control-Expose-Headers</code>头让服务器把允许浏览器访问的头放入白名单，例如：</p><pre><code>Access-Control-Expose-Headers: authorization, a, b</code></pre><p>这样JS就能够访问指定的响应头了。</p>'}}),Z().mock(/^\/api\/comment(\?.+)?$/,"get",(function(t){const e=W.parse(t.url);return Z().mock({code:0,msg:"",data:{total:30,[`rows|${e.limit||10}`]:[{id:"@guid",nickname:"@cname",content:"@cparagraph(1, 10)",createDate:"@date()","avatar|1":["https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar6.jpg","https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar4.jpg","https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar8.jpg","https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar2.jpg","https://sns-webpic-qc.xhscdn.com/202409202106/eb955cf64386c166567c2a7b974f1c31/1040g2sg317u2uvckgqdg5nrp6jr08np0oiv4qh8!nc_n_webp_mw_1","https://sns-webpic-qc.xhscdn.com/202409202106/394bdc9a7665cd512b00f69bbc6de915/1040g2sg317pv0tq3gq005ofa4t4k0hvhjph04l0!nc_n_webp_mw_1","https://sns-webpic-qc.xhscdn.com/202409202106/ba7d50fde593a701a11fb44f396394c5/1040g008317oief3mk64g5pbpkv585g1skdqgjp0!nc_n_webp_mw_1","https://sns-webpic-qc.xhscdn.com/202409202107/d2cd528cc7f3ac01533f89034ce2f0ed/1040g008317to9af4gs5g5odhg3g41kr1a8t5108!nc_n_webp_mw_1","https://sns-webpic-qc.xhscdn.com/202409202107/10a15c5713b871903cbae0cae19c0d27/1040g0083177t4sl73m0g5nqfnr6089863i3breo!nc_n_webp_mw_1","https://sns-webpic-qc.xhscdn.com/202409202109/1a199c2333a25f2bf929f0fe6a1e4a1a/1040g00831749eraq0q005o41to508k0no4ufg6o!nc_n_webp_mw_1","https://sns-webpic-qc.xhscdn.com/202409202109/08c873198a02fb4d2e1f32b088f1078d/1040g2sg317opdimd4ad05okt8mk6soc4supdj5g!nc_n_webp_mw_1"]}]}})})),Z().mock(/^\/api\/comment$/,"post",{code:0,msg:"",data:{id:"@guid",nickname:"@cname",content:"@cparagraph(1, 10)",createDate:"@date()","avatar|1":["https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar6.jpg","https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar4.jpg","https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar8.jpg","https://qiheizhiya.oss-cn-shenzhen.aliyuncs.com/image/avatar2.jpg"]}}),Z().setup({timeout:"400-500"});var G=n(6178),V=n(6848),Y=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"container",staticClass:"home-container"},[e("ul",{ref:"banners",staticClass:"banners",style:{marginTop:t.bannerMargin}},t._l(t.remoteData,(function(t){return e("li",{key:t.id},[e("CarouselItem",{attrs:{item:t}})],1)})),0),e("div",{directives:[{name:"show",rawName:"v-show",value:1!=t.current,expression:"current!=1"}],staticClass:"icon iconUp",on:{click:function(e){return t.switchTo(t.current-1)}}},[e("Icon",{attrs:{type:"arrowUp"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.current!=this.remoteData.length,expression:"current!=this.remoteData.length"}],staticClass:"icon iconDown",on:{click:function(e){return t.switchTo(t.current+1)}}},[e("Icon",{attrs:{type:"arrowDown"}})],1),e("ul",{staticClass:"indicator"},t._l(t.remoteData,(function(n,a){return e("li",{key:n.id,class:{active:a+1===t.current},on:{click:function(e){return t.switchTo(a+1)}}})})),0)])},Q=[],tt=n(4373);function et(t,e){const n=new V.Ay({render:n=>n(t,{props:e})});return n.$mount(""),n.$el}var nt={message:"yKumJjyycacU1n3nDZhZ","message-info":"poR7NdKWcww29i7o7bf9","message-danger":"wUk5bTfBsTcRb2nAs7KK","message-success":"x0sU2tK0f4ApJihraeqL","message-warn":"OdEmxp9rWsDqPCZiR4fI"};function at(t="hello world",e="danger",n="2000",a){a||(a=document.body);const s=et(C,{type:e}),i=document.createElement("div");i.classList.add("canvas"),i.innerHTML=`\n        <div>\n        ${s.outerHTML}\n        </div>   \n     <div>${t}</div>\n    `,i.className=nt.message,i.classList.add(nt[`message-${e}`]),a.appendChild(i),i.style.transform="translate(-50%, -50%) translateY(20px)",i.clientHeight,i.style.transform="translate(-50%, -50%)",i.style.opacity=1,setTimeout((()=>{i.style.transform="translate(-50%, -50%) translateY(-10px)",i.style.opacity=0,i.addEventListener("transitionend",(()=>{i.remove()}),{once:!0})}),n),"static"===getComputedStyle(a).position&&(a.style.position="relative")}var st=at;function it(t,e=5e3){let n;return function(...a){clearTimeout(n),n=setTimeout((()=>{t(...a)}),e)}}const ot=tt.A.create();ot.interceptors.response.use((function(t){return 0!==t.data.code?(st(t.data.msg),null):t.data.data}));var ct=ot;function rt(){return ct.get("/api/banner")}var lt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"carouselItem-container"},[e("ImageLoader",{attrs:{src:t.item.bigImg}}),e("div",{staticClass:"word"},[e("h1",{staticClass:"title"},[t._v(" "+t._s(t.item.title)+" ")]),e("h2",{staticClass:"description"},[t._v(" "+t._s(t.item.description)+" ")])])],1)},dt=[],pt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-loader-container"},[t.originFull?t._e():e("img",{staticClass:"placeholder",attrs:{src:t.placeholder}}),e("img",{staticClass:"origin",style:{opacity:t.originOpacity,transition:t.duration+"s"},attrs:{src:t.src},on:{load:t.handleLoad}})])},mt=[],ut={data(){return{originLoaded:!1,originFull:!1}},computed:{originOpacity(){return this.originLoaded?1:0}},props:{src:{type:String,required:!0},placeholder:{type:String,required:!1,default:"https://i.pinimg.com/474x/d9/f0/40/d9f040b713c7082d86a3513a23a6225d.jpg"},duration:{type:Number,required:!1,default:3}},methods:{handleLoad(){this.originLoaded=!0,setTimeout((()=>{this.originFull=!0,this.$emit("load","图片OK了兄弟")}),1e3*this.duration)}}},ht=ut,gt=(0,p.A)(ht,pt,mt,!1,null,"dba767f2",null),ft=gt.exports,bt={components:{ImageLoader:ft},props:["item"],created(){}},vt=bt,yt=(0,p.A)(vt,lt,dt,!1,null,"66633ff2",null),_t=yt.exports;function wt(t=[]){return{data(){return{isLoading:!0,remoteData:t}},async created(){this.remoteData=await this.fetchData(),this.isLoading=!1}}}var Ct=wt,xt={components:{CarouselItem:_t,Icon:C},mixins:[Ct([])],data(){return{current:1,containerHeight:0,isChanging:!1}},async created(){window.addEventListener("resize",this.handleResize)},beforeDestroy(){window.removeEventListener("resize",this.handleResize)},mounted(){this.containerHeight=this.$refs.container.clientHeight,this.$refs.container.addEventListener("wheel",this.handleWheel),this.$refs.banners.addEventListener("transitionend",this.handleTransitionend)},computed:{bannerMargin(){return-(this.current-1)*this.containerHeight+"px"}},methods:{async fetchData(){return await rt()},switchTo(t){this.current=t},handleResize(){this.containerHeight=this.$refs.container.clientHeight},handleWheel(t){const e=t.deltaY;Math.abs(e)<5||this.isChanging||(e>0&&this.current<this.remoteData.length?(this.current++,this.isChanging=!0):e<0&&this.current>1&&(this.current--,this.isChanging=!0))},handleTransitionend(){this.isChanging=!1}}},jt=xt,Lt=(0,p.A)(jt,Y,Q,!1,null,"c7ec2612",null),St=Lt.exports,kt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-container"},[e("Layout",{scopedSlots:t._u([{key:"right",fn:function(){return[e("BlogCategoryList")]},proxy:!0}])},[e("BlogList")],1)],1)},At=[],Dt=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"container",staticClass:"blog-list-container"},[e("ul",t._l(t.remoteData.rows,(function(n){return e("li",{key:n.id},[n.thumb?e("div",{staticClass:"thumb"},[e("img",{attrs:{src:n.thumb,alt:""}})]):t._e(),e("div",{staticClass:"main"},[e("router-link",{attrs:{to:`/blog/${n.id}`}},[e("h2",{staticClass:"title"},[t._v(t._s(n.title))])]),e("div",{staticClass:"header"},[e("span",[t._v("日期："+t._s(n.createDate))]),e("span",[t._v("浏览："+t._s(n.scanNumber))]),e("span",[t._v("评论："+t._s(n.commentNumber))])]),e("div",{staticClass:"desc"},[e("span",[t._v(t._s(n.description))])])],1)])})),0),Object.keys(t.remoteData).length?e("div",[e("Pager",{attrs:{current:t.routeInfo.page,limit:this.routeInfo.limit,total:t.remoteData.total,visibleNum:8},on:{changePage:t.handleChangePage}})],1):t._e()])},qt=[];n(4114);async function Tt(){return await ct.get("/api/blogtype")}async function Ot(t=1,e=10,n=-1){return await ct.get("/api/blog",{params:{page:t,limit:e,categotyid:n}})}async function Nt(t){return await ct.get(`/api/blog/${t}`)}async function It(t){return await ct.post("/api/comment",t)}async function $t(t,e=1,n=5){return await ct.get("/api/comment",{params:{blogId:t,page:e,limit:n}})}var Pt=function(){var t=this,e=t._self._c;return t.pageNumber>1?e("div",{staticClass:"pager-container"},[e("a",{class:{disabled:1===t.current},on:{click:function(e){return t.handlePageChange(1)}}},[t._v("|<<")]),e("a",{class:{disabled:1===t.current},on:{click:function(e){return t.handlePageChange(t.current-1)}}},[t._v("<")]),t._l(t.numbers,(function(n,a){return e("a",{key:a,class:{active:n===t.current},on:{click:function(e){return t.handlePageChange(n)}}},[t._v(t._s(n))])})),e("a",{class:{disabled:t.current===t.pageNumber},on:{click:function(e){return t.handlePageChange(t.current+1)}}},[t._v(">")]),e("a",{class:{disabled:t.current===t.pageNumber},on:{click:function(e){return t.handlePageChange(t.pageNumber)}}},[t._v(">>|")])],2):t._e()},Rt=[],zt={props:{current:{type:Number,default:1},limit:{type:Number,default:10},total:{type:Number,default:100},visibleNum:{type:Number,default:10}},computed:{pageNumber(){return Math.ceil(this.total/this.limit)},numbers(){let t=[];for(let e=this.minPage;e<=this.maxPage;e++)t.push(e);return t},minPage(){const t=this.current-Math.floor(this.visibleNum/2);return t<1?1:t},maxPage(){const t=this.minPage+this.visibleNum-1;return t>this.pageNumber?this.pageNumber:t}},methods:{handlePageChange(t){t<1&&(t=1),t>this.pageNumber&&(t=this.pageNumber),t!=this.current&&this.$emit("changePage",t)}}},Ht=zt,Mt=(0,p.A)(Ht,Pt,Rt,!1,null,"ad344068",null),Et=Mt.exports,Bt={components:{Pager:Et},mixins:[Ct({})],methods:{async fetchData(){return await Ot(this.routeInfo.page,this.routeInfo.limit,this.routeInfo.cateId)},handleChangePage(t){-1===this.routeInfo.cateId?this.$router.push({name:"blog",query:{page:t.toString(),limit:this.routeInfo.limit}}):this.$router.push({name:"cate",params:{cateId:this.routeInfo.cateId},query:{page:t.toString(),limit:this.routeInfo.limit}})}},computed:{routeInfo(){const t=this.$route.params.cateId||-1,e=+this.$route.query.limit||10,n=+this.$route.query.page||1;return{cateId:t,limit:e,page:n}}},watch:{async routeInfo(t,e){this.$refs.container.scrollTop=0,this.isLoading=!0,this.remoteData=await this.fetchData(),this.isLoading=!1}}},Jt=Bt,Ut=(0,p.A)(Jt,Dt,qt,!1,null,"1a884cb5",null),Kt=Ut.exports,Ft=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"blog-category-list"},[e("h3",[t._v(" 文章分类 ")]),t.cateList.length>1?e("right-list",{attrs:{list:t.cateList},on:{select:t.headleSelect}}):t._e()],1)},Xt=[],Zt=function(){var t=this,e=t._self._c;return t.list.length>0?e("ul",{staticClass:"right-list-container"},t._l(t.list,(function(n,a){return e("li",{key:a},[e("span",{class:{active:n.isSelected},on:{click:function(e){return t.handleClick(n)}}},[t._v(t._s(n.name))]),n.articleCount?e("span",{staticClass:"note"},[t._v(" <"+t._s(n.articleCount)+">")]):t._e(),n.children?e("RightList",t._g({attrs:{list:n.children}},t.$listeners)):t._e()],1)})),0):t._e()},Wt=[],Gt={name:"RightList",props:{list:{type:Array,default:()=>[]}},methods:{handleClick(t){this.$emit("select",t)}}},Vt=Gt,Yt=(0,p.A)(Vt,Zt,Wt,!1,null,"1396eaeb",null),Qt=Yt.exports,te={mixins:[Ct([])],methods:{async fetchData(){const t=await Tt();return t},headleSelect(t){t.isSelected||this.$router.push({name:"cate",params:{cateId:t.id.toString()},query:this.routeInfo.query})}},components:{RightList:Qt},computed:{routeInfo(){const t=this.$route.params.cateId||-1,e=+this.$route.query.limit||10,n=+this.$route.query.page||1;return{params:{cateId:t},query:{limit:e,page:n}}},cateId:function(){return+this.$route.params.cateId||-1},cateList(){const t=this.remoteData.reduce(((t,e)=>t+e.articleCount),0),e=[{id:-1,name:"全部",articleCount:t},...this.remoteData],n=e.map((t=>({...t,isSelected:t.id===this.cateId})));return n}}},ee=te,ne=(0,p.A)(ee,Ft,Xt,!1,null,"7b9d387a",null),ae=ne.exports,se={components:{Layout:B,BlogList:Kt,BlogCategoryList:ae}},ie=se,oe=(0,p.A)(ie,kt,At,!1,null,null,null),ce=oe.exports,re=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"about-container"},[e("iframe",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"about-content",attrs:{src:"//player.bilibili.com/player.html?isOutside=true&aid=789569045&bvid=BV1DC4y1d7gd&cid=1296868410&p=1",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"},on:{load:t.handleLoad}})])},le=[],de={data(){return{isLoading:!0}},methods:{handleLoad(){this.isLoading=!1}}},pe=de,me=(0,p.A)(pe,re,le,!1,null,"a9473cdc",null),ue=me.exports,he=function(){var t=this,e=t._self._c;return e("div",{staticClass:"project-container"},[t._m(0),e("div",{attrs:{id:"banner"}},[e("div",{staticClass:"img-list img-wrapper"},[e("div",{staticClass:"img-box"},[t._m(1),e("img",{attrs:{src:t.img[5],alt:""}})]),e("div",{staticClass:"img-box"},[t._m(2),e("img",{attrs:{src:t.img[2],alt:""}})]),e("div",{staticClass:"img-box"},[t._m(3),e("img",{attrs:{src:t.img[4],alt:""}})]),e("div",{staticClass:"img-box"},[t._m(4),e("img",{attrs:{src:t.img[1],alt:""}})]),e("div",{staticClass:"img-box"},[t._m(5),e("img",{attrs:{src:t.img[3],alt:""}})]),e("div",{staticClass:"img-box",attrs:{id:"last-img-box"}},[t._m(6),e("img",{attrs:{src:t.img[0],alt:""}})])])]),e("div",{staticClass:"btn-group"},[e("button",{staticClass:"last btn"},[e("svg",{staticClass:"icon left",attrs:{t:"1686471404424",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2373",width:"128",height:"128"}},[e("path",{attrs:{d:"M862.485 481.154H234.126l203.3-203.3c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0L135.397 489.373c-12.497 12.497-12.497 32.758 0 45.254l256.774 256.775c6.249 6.248 14.438 9.372 22.627 9.372s16.379-3.124 22.627-9.372c12.497-12.497 12.497-32.759 0-45.255l-203.3-203.301h628.36c17.036 0 30.846-13.81 30.846-30.846s-13.81-30.846-30.846-30.846z",fill:"","p-id":"2374"}})])]),e("button",{staticClass:"next btn"},[e("svg",{staticClass:"icon right",attrs:{t:"1686471404424",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2373",width:"128",height:"128"}},[e("path",{attrs:{d:"M862.485 481.154H234.126l203.3-203.3c12.497-12.497 12.497-32.758 0-45.255s-32.758-12.497-45.255 0L135.397 489.373c-12.497 12.497-12.497 32.758 0 45.254l256.774 256.775c6.249 6.248 14.438 9.372 22.627 9.372s16.379-3.124 22.627-9.372c12.497-12.497 12.497-32.759 0-45.255l-203.3-203.301h628.36c17.036 0 30.846-13.81 30.846-30.846s-13.81-30.846-30.846-30.846z",fill:"","p-id":"2374"}})])])])])},ge=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[e("p",[t._v(" 👋🏾 Welcome")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info"},[e("h3",[t._v("Hand drawn")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info"},[e("h3",[t._v("Device")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info"},[e("h3",[t._v("Angel")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info"},[e("h3",[t._v("Punk")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info"},[e("h3",[t._v("Devil")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info"},[e("h3",[t._v("Cover")])])}],fe=n.p+"img/1.1bc0585d.png",be=n.p+"img/2.aafbf3ba.png",ve=n.p+"img/3.0068d459.png",ye=n.p+"img/4.ab0d9958.png",_e=n.p+"img/5.b977b9fb.png",we=n.p+"img/6.29bcc939.png",Ce={data(){return{img:[fe,be,ve,ye,_e,we]}},mounted(){const t=document.querySelector(".img-list");let e=Array.prototype.slice.call(document.querySelectorAll(".img-list .img-box"));const n=e.length,a=document.querySelector(".project-container"),s=document.querySelector(".btn-group"),i=document.querySelector(".last"),o=document.querySelector(".next"),c=document.getElementById("last-img-box"),r=Number(getComputedStyle(a).getPropertyValue("--post-spacing").replace("vw","")),l=Number(getComputedStyle(a).getPropertyValue("--post-size").replace("vw",""));const d=l+r;let p=0,m=null,u=.5;function h(a){"next"==a?(p--,t.style.left=d*p+"vw",setTimeout((function(){t.style.transition="none",Math.abs(p)==n?(p=0,t.style.left=0,e.forEach((t=>{"last-img-box"==t.id?t.style.transform="translateX(-160.68vw)":t.style.transform="none"}))):"last-img-box"==e[0].id?c.style.transform="translateX(0px)":e[0].style.transform=p>=0?"none":"translateX(160.68vw)",e.push(e.shift())}),1e3*u)):(p++,e.unshift(e.pop()),"last-img-box"==e[0].id&&0!=p?e[0].style.transform="translateX(-321.36vw)":e[0].style.transform=p<0?"none":"translateX(-160.68vw)",t.style.left=d*p+"vw",Math.abs(p)==n&&(p=0,setTimeout((function(){t.style.left=0,e.forEach((t=>{"last-img-box"==t.id?t.style.transform="translateX(-160.68vw)":t.style.transform="none"}))}),1e3*u))),t.style.transition=u+"s ease"}function g(t,e){return function(){m||(t.apply(this,arguments),m=setTimeout((()=>{m=null}),e))}}e.unshift(e.pop()),t.style.transition=u+"s ease",setTimeout((function(){s.style.opacity="1",s.style.bottom="5%"}),1e3*u),o.onclick=()=>{h("next")},i.onclick=g((()=>h("last")),1e3*u)}},xe=Ce,je=(0,p.A)(xe,he,ge,!1,null,"153923f2",null),Le=je.exports,Se=function(){var t=this,e=t._self._c;return e("div",{staticClass:"message-container"},[e("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"center",height:"100%","margin-left":"2rem"}},[e("div",{class:["phone",t.isLight?"light":"dark"]},[e("div",{attrs:{id:"top-menu"}},[t._m(0),e("button",{staticClass:"button",attrs:{id:"mode"},on:{click:function(e){t.isLight=!t.isLight}}},[e("i",{class:["bi bi-brightness-high-fill",{"bi-moon":!t.isLight}]})]),t._m(1)]),t._m(2),t._m(3),e("div",{staticClass:"song-controls"},[e("audio",{staticClass:"audio",attrs:{src:t.songUrl,controls:""}})])])]),t._m(4)])},ke=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"button"},[e("i",{staticClass:"fas fa-arrow-left"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"button"},[e("i",{staticClass:"fas fa-bars"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"thumbnail-border"},[e("div",{staticClass:"song-thumbnail"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"song-detail"},[e("h1",{staticClass:"song-title"},[t._v("红")]),e("span",{staticClass:"artist"},[t._v("罗言RollFish")])])},function(){var t=this,e=t._self._c;return e("div",[e("canvas")])}],Ae=(n(6573),n(8100),n(7936),n(7467),n(4732),n(9577),n.p+"media/rollfish.8314cc2c.mp3"),De={data(){return{songUrl:Ae,isLight:!0}},mounted(){const t=document.querySelector("audio"),e=document.querySelector("canvas"),n=e.getContext("2d");function a(){e.width=500*devicePixelRatio,e.height=200*devicePixelRatio}a();let s,i,o=!1;function c(){requestAnimationFrame(c);const{width:t,height:a}=e;if(n.clearRect(0,0,t,a),!o)return;i.getByteFrequencyData(s);const r=s.length/2.5,l=t/r/2;for(let e=0;e<r;e++){const i=s[e],o=i/255*a,c=e*l+t/2,r=t/2-(e+1)*l,d=a-o;n.fillRect(c,d,l-2,o),n.fillRect(r,d,l-2,o)}}t.addEventListener("play",(()=>{if(o)return;const e=new AudioContext,n=e.createMediaElementSource(t);i=e.createAnalyser(),i.fftSize=512,s=new Uint8Array(i.frequencyBinCount),n.connect(i),i.connect(e.destination),o=!0})),c()}},qe=De,Te=(0,p.A)(qe,Se,ke,!1,null,"fb2922be",null),Oe=Te.exports,Ne=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"detail-container"},[e("Layout",{scopedSlots:t._u([{key:"right",fn:function(){return[e("div",{staticClass:"right-container"},[t.remoteData?e("BlogToc",{attrs:{toc:t.remoteData.toc}}):t._e()],1)]},proxy:!0}])},[e("div",{ref:"mainContainer",staticClass:"main-container",on:{scroll:t.handleScroll}},[t.remoteData?e("BlogContent",{attrs:{content:t.remoteData}}):t._e(),t.remoteData?e("BlogComment"):t._e()],1)])],1)},Ie=[],$e=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-content-container"},[e("h2",[t._v(t._s(t.content.title)+" ")]),e("div",{staticClass:"header"},[e("span",[t._v("日期："+t._s(t.content.createDate))]),e("span",[t._v("浏览："+t._s(t.content.scanNumber))]),e("span",[e("a",{attrs:{href:"#message-bar-container"}},[t._v("评论："+t._s(t.content.commentNumber))])]),e("span",[t._v(t._s(t.content.category.name))])]),e("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.content.htmlContent)}})])},Pe=[],Re={props:{content:{required:!0,type:Object}}},ze=Re,He=(0,p.A)(ze,$e,Pe,!1,null,"4111a557",null),Me=He.exports,Ee=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-toc-container"},[e("RightList",{attrs:{list:t.modifiedToc},on:{select:t.handleSelect}})],1)},Be=[],Je={components:{RightList:Qt},props:{toc:{type:Array,required:!0}},methods:{handleSelect(t){location.hash=t.anchor},setSelected(){this.whoSelected="";const t=400;for(const e of this.titleDom){const n=e.getBoundingClientRect();if(n.top>0&&n.top<=t){this.whoSelected=e.id;break}if(n.top>t)break;n.top<0&&(this.whoSelected=e.id)}}},data(){return{whoSelected:"",titleDom:[]}},mounted(){const t=location.hash;location.hash="",location.hash=t,this.setSelectedDebounce=it(this.setSelected,50),this.$bus.$on("scroll",this.setSelectedDebounce);for(const e of this.titleName)this.titleDom.push(document.querySelector(`#${e}`))},destroyed(){this.$bus.$off("scroll",this.setSelectedDebounce)},computed:{modifiedToc(){const t=(e=[])=>e.map((e=>{let n={...e,isSelected:this.whoSelected===e.anchor};return e.children&&(n.children=t(e.children)),n}));return t(this.toc)},titleName(){let t=[];function e(n=[]){if(n&&!(n.length<1))for(const a of n)t.push(a.anchor),a.children&&e(a.children)}return e(this.toc),t}}},Ue=Je,Ke=(0,p.A)(Ue,Ee,Be,!1,null,"28baef40",null),Fe=Ke.exports,Xe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-comment-container"},[t.remoteData?e("MessageBar",{staticClass:"message-bar-container",attrs:{comments:t.remoteData,isListLoading:t.isListLoading},on:{submit:t.handleSubmit}}):t._e()],1)},Ze=[],We=function(){var t=this,e=t._self._c;return e("div",{staticClass:"message-bar-container",attrs:{id:"message-bar-container"}},[e("div",{staticClass:"title",staticStyle:{display:"flex"}},[e("h2",[t._v(t._s(t.title))]),e("h5",{staticStyle:{"text-align":"center"}},[t._v("("+t._s(t.comments.total)+")")])]),e("DataForm",t._g({},t.$listeners)),e("DataList",{attrs:{comments:t.comments}}),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isListLoading,expression:"isListLoading"}],staticClass:"loading"})],1)},Ge=[],Ve=function(){var t=this,e=t._self._c;return e("form",{ref:"form",staticClass:"data-form-container",on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[e("div",{staticClass:"form-item"},[e("div",{staticClass:"input-area"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickname,expression:"formData.nickname"}],attrs:{type:"text",maxlength:"10",placeholder:"用户昵称"},domProps:{value:t.formData.nickname},on:{input:function(e){e.target.composing||t.$set(t.formData,"nickname",e.target.value)}}}),e("span",{staticClass:"tip"},[t._v(t._s(t.formData.nickname.length)+"/10")])]),e("div",{staticClass:"error"},[t._v(t._s(t.error.nickname))])]),e("div",{staticClass:"form-item"},[e("div",{staticClass:"text-area"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],attrs:{maxlength:"300",placeholder:"输入内容"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),e("span",{staticClass:"tip"},[t._v(t._s(t.formData.content.length)+"/300")])]),e("div",{staticClass:"error"},[t._v(t._s(t.error.content))])]),e("div",{staticClass:"form-item"},[e("div",{staticClass:"button-area"},[e("button",{attrs:{disabled:t.isSubmiting}},[t._v(" "+t._s(t.isSubmiting?"提交中...":"提交")+" ")])])])])},Ye=[],Qe={data(){return{formData:{nickname:"",content:""},error:{nickname:"",content:""},isSubmiting:!1}},methods:{handleSubmit(){this.error.nickname=this.formData.nickname?"":"请填写昵称",this.error.content=this.formData.content?"":"请填写内容",this.error.nickname||this.error.content||(this.isSubmiting=!0,this.$emit("submit",this.formData,(()=>{this.formData.nickname="",this.formData.content="",this.isSubmiting=!1,st("提交成功！","success",2e3,this.$refs.form)})))}}},tn=Qe,en=(0,p.A)(tn,Ve,Ye,!1,null,"1361707c",null),nn=en.exports,an=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"data-list-container"},t._l(t.comments.rows,(function(n){return e("li",{key:n.id},[e("Avatar",{attrs:{url:n.avatar,size:44,isSolid:!0}}),e("div",{staticClass:"data"},[e("div",{staticClass:"nickname"},[t._v(t._s(n.nickname))]),e("div",{staticClass:"content"},[t._v(t._s(n.content))]),e("div",{staticClass:"time"},[t._v(t._s(n.createDate))])])],1)})),0)},sn=[],on={components:{Avatar:u},props:{comments:{type:Object,required:!0}}},cn=on,rn=(0,p.A)(cn,an,sn,!1,null,"dfa79e9e",null),ln=rn.exports,dn={components:{DataForm:nn,DataList:ln},props:{comments:{type:Object,required:!0},title:{type:String,default:"评论区"},isListLoading:{type:Boolean,default:!1}}},pn=dn,mn=(0,p.A)(pn,We,Ge,!1,null,"62696c30",null),un=mn.exports,hn={components:{MessageBar:un},mixins:[Ct(null)],data(){return{page:1,isListLoading:!1}},created(){this.$bus.$on("scroll",it(this.scrollHandler,50))},methods:{async fetchData(){const t=await $t(this.$route.params.blogId,this.page);return t},async scrollHandler(t){const e=t.scrollHeight-t.scrollTop-t.clientHeight;Math.abs(e)<100&&this.fetchMore()},async fetchMore(){if(this.remoteData.rows.length>=this.remoteData.total||this.isListLoading)return;this.isListLoading=!0,this.page++;const t=await this.fetchData();this.remoteData.rows=this.remoteData.rows.concat(t.rows),this.isListLoading=!1},async handleSubmit(t,e){const n=await It({blogId:this.$route.blogId,...t});this.remoteData.rows.unshift(n),e()}}},gn=hn,fn=(0,p.A)(gn,Xe,Ze,!1,null,"1da74bbb",null),bn=fn.exports,vn={components:{Layout:B,BlogContent:Me,BlogToc:Fe,BlogComment:bn},mixins:[Ct(null)],methods:{async fetchData(){const t=await Nt(this.$route.params.id);return t},handleScroll(){this.$bus.$emit("scroll",this.$refs.mainContainer)}}},yn=vn,_n=(0,p.A)(yn,Ne,Ie,!1,null,"11a9b943",null),wn=_n.exports,Cn=[{name:"home",path:"/",component:St},{name:"index",path:"/index.html",component:St},{name:"blog",path:"/blog",component:ce},{name:"about",path:"/about",component:ue},{name:"project",path:"/gallery",component:Le},{name:"message",path:"/music",component:Oe},{name:"cate",path:"/blog/cate/:cateId",component:ce},{name:"detail",path:"/blog/:blogId",component:wn}];V.Ay.use(G.Ay);var xn=new G.Ay({routes:Cn,mode:"history"}),jn={loading:"n6c054pmEgLPauvpFm9c"},Ln=n.p+"img/loading.e63029c1.svg";function Sn(t){return t.querySelector("img[data-role=loading]")}function kn(t){const e=document.createElement("img");e.src=Ln,e.dataset.role="loading",e.classList.add(jn.loading),t.appendChild(e)}function An(t,e){const n=Sn(t);e.value?n||kn(t):n&&n.remove()}const Dn=new V.Ay({});V.Ay.prototype.$bus=Dn;const qn=n(6848).Ay;qn.config.devtools=!0,qn.prototype.$showPopup=st,qn.directive("loading",An),new qn({router:xn,render:function(t){return t(F)}}).$mount("#app")}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var i=e[a]={exports:{}};return t[a].call(i.exports,i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,a,s,i){if(!a){var o=1/0;for(d=0;d<t.length;d++){a=t[d][0],s=t[d][1],i=t[d][2];for(var c=!0,r=0;r<a.length;r++)(!1&i||o>=i)&&Object.keys(n.O).every((function(t){return n.O[t](a[r])}))?a.splice(r--,1):(c=!1,i<o&&(o=i));if(c){t.splice(d--,1);var l=s();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[a,s,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,i,o=a[0],c=a[1],r=a[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(s in c)n.o(c,s)&&(n.m[s]=c[s]);if(r)var d=r(n)}for(e&&e(a);l<o.length;l++)i=o[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(d)},a=self["webpackChunkZONE"]=self["webpackChunkZONE"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(9631)}));a=n.O(a)})();
//# sourceMappingURL=app.7ec24c27.js.map